%% Q1
% ? ????? ??? ??????? ????? jpg.
% ? ????? ??? ????????? ????? unsigned integer 8 ???bits
A = imread('mammo.jpg');

%% Q2 
figure(1);
title("Analysis");
subplot(1, 2, 1);
imshow(A);
subplot(1, 2, 2);
imhist(A);

% ??????????? ??? ? ????? ??? ??????? ??? ???????? ????? and paper.

%% Q3
meanfilter = fspecial('average', [5 5]);
meanfilter_manual = ones([5 5]) / 25;
A_mean = imfilter(A, meanfilter);
figure(2);
subplot(1, 2, 1);
title('Average Filter');
imshow(A_mean);

A_med = medfilt2(A, [5 5]);
subplot(1, 2, 2);
title('Median Filter');
imshow(A_med);

A2 = A_med;

% ?? ???????????? ?? plots, ???????? ?? ????????????? ??? ???? ?????????
% ??? mean ????? ???????????? ???? ???????, ??? ??? ?????????? ???, ???
% ???????? ??????? ?? median.

%% Q4 
A_min_before = min(A(:));
A_max_before = max(A(:));
A_min_after = min(A2(:));
A_max_after = max(A2(:));

%% Q5 
figure(3);
subplot(1, 2, 1);
imshow(A2);
subplot(1, 2, 2);
plot(A2(1100, :));

% ? ??????? ?(1100, 0:250) ???? ???????? ?????????? ???? ??? ?????????

%% Q6 
figure(4);
subplot(1, 2, 1);
imshow(A2);
subplot(1, 2, 2);
plot(A2(:, 1550));

% ??????? 875 ?? 3865

%% Q7
figure(5);
subplot(1, 2, 1);
imshow(A2);
subplot(1, 2, 2);
plot(A2(2700, :));

% ?????? ???? ?? 700

%% Q8
figure(6);
ROI = A2(875:4000, 660:end);
imshow(ROI);
A3 = ROI;

%% Q9 
B = imresize(A3, 0.2);

%% Q10
figure(7);
level = graythresh(B);
B_bw = imbinarize(B, level);
imshow(B_bw);

% ?? ???????????? ?? ???????????? ?????:
i = 1;
figure(8);
for level = 0.1:0.05:0.5
    test_img = imbinarize(B, level);
    subplot(1, 9, i);
    imshow(test_img);
    title(level);
    i = i + 1;
end

% ???????? ????????????? ??? ? ???????? ???? ????? ?? 0.15
figure(9);
B_bw = imbinarize(B, 0.15);

%% Q11
figure(11);
se = strel('sphere', 10);

subplot(1, 3, 1);
imshow(B_bw);
title('Initial');

subplot(1, 3, 2);
B2 = imopen(B_bw, se);
imshow(B2);
title('After open');

subplot(1, 3, 3);
B2 = imclose(B2, se);
imshow(B2);
title('Final');

%% Q12
figure(12);
edges = edge(B_bw, 'canny');
subplot(1, 2, 1);
imshow(B);
subplot(1, 2, 2);
imshow(edges);